"use strict";(self.webpackChunkayon_docs=self.webpackChunkayon_docs||[]).push([[5808],{18679:(e,t,r)=>{r.d(t,{Z:()=>o});var a=r(67294),n=r(86010);const s={tabItem:"tabItem_Ymn6"};function o(e){let{children:t,hidden:r,className:o}=e;return a.createElement("div",{role:"tabpanel",className:(0,n.Z)(s.tabItem,o),hidden:r},t)}},73992:(e,t,r)=>{r.d(t,{Z:()=>_});var a=r(87462),n=r(67294),s=r(86010),o=r(72957),l=r(16550),i=r(75238),u=r(33609),c=r(92560);function p(e){return function(e){return n.Children.map(e,(e=>{if(!e||(0,n.isValidElement)(e)&&function(e){const{props:t}=e;return!!t&&"object"==typeof t&&"value"in t}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}(e).map((e=>{let{props:{value:t,label:r,attributes:a,default:n}}=e;return{value:t,label:r,attributes:a,default:n}}))}function d(e){const{values:t,children:r}=e;return(0,n.useMemo)((()=>{const e=t??p(r);return function(e){const t=(0,u.l)(e,((e,t)=>e.value===t.value));if(t.length>0)throw new Error(`Docusaurus error: Duplicate values "${t.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[t,r])}function b(e){let{value:t,tabValues:r}=e;return r.some((e=>e.value===t))}function m(e){let{queryString:t=!1,groupId:r}=e;const a=(0,l.k6)(),s=function(e){let{queryString:t=!1,groupId:r}=e;if("string"==typeof t)return t;if(!1===t)return null;if(!0===t&&!r)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return r??null}({queryString:t,groupId:r});return[(0,i._X)(s),(0,n.useCallback)((e=>{if(!s)return;const t=new URLSearchParams(a.location.search);t.set(s,e),a.replace({...a.location,search:t.toString()})}),[s,a])]}function h(e){const{defaultValue:t,queryString:r=!1,groupId:a}=e,s=d(e),[o,l]=(0,n.useState)((()=>function(e){let{defaultValue:t,tabValues:r}=e;if(0===r.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(t){if(!b({value:t,tabValues:r}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${t}" but none of its children has the corresponding value. Available values are: ${r.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return t}const a=r.find((e=>e.default))??r[0];if(!a)throw new Error("Unexpected error: 0 tabValues");return a.value}({defaultValue:t,tabValues:s}))),[i,u]=m({queryString:r,groupId:a}),[p,h]=function(e){let{groupId:t}=e;const r=function(e){return e?`docusaurus.tab.${e}`:null}(t),[a,s]=(0,c.Nk)(r);return[a,(0,n.useCallback)((e=>{r&&s.set(e)}),[r,s])]}({groupId:a}),f=(()=>{const e=i??p;return b({value:e,tabValues:s})?e:null})();(0,n.useLayoutEffect)((()=>{f&&l(f)}),[f]);return{selectedValue:o,selectValue:(0,n.useCallback)((e=>{if(!b({value:e,tabValues:s}))throw new Error(`Can't select invalid tab value=${e}`);l(e),u(e),h(e)}),[u,h,s]),tabValues:s}}var f=r(51048);const v={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};function k(e){let{className:t,block:r,selectedValue:l,selectValue:i,tabValues:u}=e;const c=[],{blockElementScrollPositionUntilNextRender:p}=(0,o.o5)(),d=e=>{const t=e.currentTarget,r=c.indexOf(t),a=u[r].value;a!==l&&(p(t),i(a))},b=e=>{let t=null;switch(e.key){case"Enter":d(e);break;case"ArrowRight":{const r=c.indexOf(e.currentTarget)+1;t=c[r]??c[0];break}case"ArrowLeft":{const r=c.indexOf(e.currentTarget)-1;t=c[r]??c[c.length-1];break}}t?.focus()};return n.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,s.Z)("tabs",{"tabs--block":r},t)},u.map((e=>{let{value:t,label:r,attributes:o}=e;return n.createElement("li",(0,a.Z)({role:"tab",tabIndex:l===t?0:-1,"aria-selected":l===t,key:t,ref:e=>c.push(e),onKeyDown:b,onClick:d},o,{className:(0,s.Z)("tabs__item",v.tabItem,o?.className,{"tabs__item--active":l===t})}),r??t)})))}function y(e){let{lazy:t,children:r,selectedValue:a}=e;const s=(Array.isArray(r)?r:[r]).filter(Boolean);if(t){const e=s.find((e=>e.props.value===a));return e?(0,n.cloneElement)(e,{className:"margin-top--md"}):null}return n.createElement("div",{className:"margin-top--md"},s.map(((e,t)=>(0,n.cloneElement)(e,{key:t,hidden:e.props.value!==a}))))}function w(e){const t=h(e);return n.createElement("div",{className:(0,s.Z)("tabs-container",v.tabList)},n.createElement(k,(0,a.Z)({},e,t)),n.createElement(y,(0,a.Z)({},e,t)))}function _(e){const t=(0,f.Z)();return n.createElement(w,(0,a.Z)({key:String(t)},e))}},1822:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>i,contentTitle:()=>o,default:()=>d,frontMatter:()=>s,metadata:()=>l,toc:()=>u});var a=r(87462),n=(r(67294),r(3905));r(73992),r(18679);const s={id:"admin_webserver_for_webpublisher",title:"Webserver for webpublisher",sidebar_label:"Web Publisher"},o=void 0,l={unversionedId:"admin_webserver_for_webpublisher",id:"admin_webserver_for_webpublisher",title:"Webserver for webpublisher",description:"This document is obsolete.",source:"@site/docs/admin_webserver_for_webpublisher.md",sourceDirName:".",slug:"/admin_webserver_for_webpublisher",permalink:"/docs/admin_webserver_for_webpublisher",draft:!1,editUrl:"https://github.com/ynput/ayon-documentation/tree/main/website/docs/admin_webserver_for_webpublisher.md",tags:[],version:"current",frontMatter:{id:"admin_webserver_for_webpublisher",title:"Webserver for webpublisher",sidebar_label:"Web Publisher"},sidebar:"Admin",previous:{title:"Zbrush",permalink:"/docs/addon_zbrush_admin"},next:{title:"Releases",permalink:"/docs/admin_releases"}},i={},u=[],c={toc:u},p="wrapper";function d(e){let{components:t,...r}=e;return(0,n.kt)(p,(0,a.Z)({},c,r,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("admonition",{type:"note"},(0,n.kt)("p",{parentName:"admonition"},"This document is obsolete.")),(0,n.kt)("p",null,"Running AYON webserver is needed as a backend part for Web publishing.\nAny OS supported by AYON could be used as a host server."),(0,n.kt)("p",null,"Webpublishing consists of two sides, Front end (FE) and AYON backend. This documentation is only targeted on OP side."),(0,n.kt)("p",null,"It is expected that FE and OP will live on two separate servers, FE publicly available, OP safely in customer network."),(0,n.kt)("h1",{id:"requirements-for-servers"},"Requirements for servers"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"OP server allows access to its ",(0,n.kt)("inlineCode",{parentName:"li"},"8079")," port for FE. (It is recommended to whitelist only FE IP.)"),(0,n.kt)("li",{parentName:"ul"},"have shared folder for published resources (images, workfiles etc) on both servers")),(0,n.kt)("h1",{id:"prepare-ftrack"},"Prepare Ftrack"),(0,n.kt)("p",null,"Current webpublish process expects authentication via Slack. It is expected that customer has users created on a Ftrack with same email addresses as on Slack. As some customer might have usernames different from emails, conversion from email to username is needed."),(0,n.kt)("p",null,'For this "ynput" user needs to be present on Ftrack, creation of this user should be standard part of Ftrack preparation for AYON.\nNext create API key on Ftrack, store this information temporarily as you won\'t have access to this key after creation.'),(0,n.kt)("h1",{id:"prepare-ayon"},"Prepare AYON"),(0,n.kt)("p",null,"Deploy OP build distribution (AYON Igniter) on an OS of your choice."),(0,n.kt)("p",null,"##Run webserver as a Linux service:"),(0,n.kt)("p",null,"(This expects that OP Igniter is deployed to ",(0,n.kt)("inlineCode",{parentName:"p"},"opt/ayon")," and log should be stored in ",(0,n.kt)("inlineCode",{parentName:"p"},"/tmp/ayon.log"),")"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"create file ",(0,n.kt)("inlineCode",{parentName:"p"},"sudo vi /opt/ayon/webpublisher_webserver.sh"))),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"paste content"))),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-sh"},"#!/usr/bin/env bash\nexport AYON_DEBUG=3\nexport FTRACK_BOT_API_USER=YOUR_API_USER\nexport FTRACK_BOT_API_KEY=YOUR_API_KEY\nexport PYTHONDONTWRITEBYTECODE=1\nexport AYON_MONGO=YOUR_MONGODB_CONNECTION\n\npushd /opt/ayon\n./openpype_console webpublisherwebserver --upload_dir YOUR_SHARED_FOLDER_ON_HOST  --executable /opt/ayon/openpype_console  --host YOUR_HOST_IP --port YOUR_HOST_PORT > /tmp/ayon.log 2>&1\n")),(0,n.kt)("ol",null,(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},"create service file ",(0,n.kt)("inlineCode",{parentName:"p"},"sudo vi /etc/systemd/system/openpye-webserver.service"))),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},"paste content"))),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-sh"},"[Unit]\nDescription=Run ayon Ftrack Webserver Service\nAfter=network.target\n\n[Service]\nType=idle\nExecStart=/opt/ayon/webpublisher_webserver.sh\nRestart=on-failure\nRestartSec=10s\nStandardOutput=append:/tmp/ayon.log\nStandardError=append:/tmp/ayon.log\n\n[Install]\nWantedBy=multi-user.target\n")),(0,n.kt)("ol",{start:5},(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},"change file permission:\n",(0,n.kt)("inlineCode",{parentName:"p"},"sudo chmod 0755 /etc/systemd/system/ayon-webserver.service"))),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},"enable service:\n",(0,n.kt)("inlineCode",{parentName:"p"},"sudo systemctl enable ayon-webserver"))),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},"start service:\n",(0,n.kt)("inlineCode",{parentName:"p"},"sudo systemctl start ayon-webserver"))),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},"Check ",(0,n.kt)("inlineCode",{parentName:"p"},"/tmp/ayon.log")," if OP got started"))),(0,n.kt)("p",null,"(Note: service could be restarted by ",(0,n.kt)("inlineCode",{parentName:"p"},"service ayon-webserver restart")," - this will result in purge of current log file!)"))}d.isMDXComponent=!0}}]);