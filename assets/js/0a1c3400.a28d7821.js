"use strict";(self.webpackChunkayon_docs=self.webpackChunkayon_docs||[]).push([[6461],{21736:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>i,default:()=>m,frontMatter:()=>a,metadata:()=>p,toc:()=>l});var o=n(87462),r=(n(67294),n(3905));const a={id:"admin_import_openpype_project",title:"Importing OpenPype project to AYON",sidebar_label:"Importing OpenPype projects"},i=void 0,p={unversionedId:"admin_import_openpype_project",id:"admin_import_openpype_project",title:"Importing OpenPype project to AYON",description:"Introduction",source:"@site/docs/admin_import_openpype_project.md",sourceDirName:".",slug:"/admin_import_openpype_project",permalink:"/docs/admin_import_openpype_project",draft:!1,editUrl:"https://github.com/ynput/ayon-documentation/tree/main/website/docs/admin_import_openpype_project.md",tags:[],version:"current",frontMatter:{id:"admin_import_openpype_project",title:"Importing OpenPype project to AYON",sidebar_label:"Importing OpenPype projects"},sidebar:"Admin",previous:{title:"Releases",permalink:"/docs/admin_releases"}},s={},l=[{value:"Introduction",id:"introduction",level:2},{value:"What makes an OpenPype project",id:"what-makes-an-openpype-project",level:3},{value:"Differences",id:"differences",level:3},{value:"Project Migration prerequisites",id:"project-migration-prerequisites",level:2},{value:"I. Exporting project from OpenPype",id:"i-exporting-project-from-openpype",level:3},{value:"Export from termnial:",id:"export-from-termnial",level:4},{value:"Export from console:",id:"export-from-console",level:4},{value:"II. Setting up ASH",id:"ii-setting-up-ash",level:3},{value:"Project Migration Steps",id:"project-migration-steps",level:2},{value:"I. Get OpenPype Importer Addon",id:"i-get-openpype-importer-addon",level:3},{value:"Option 1: Just Download It!",id:"option-1-just-download-it",level:4},{value:"Option 2: Export the addon yourself",id:"option-2-export-the-addon-yourself",level:4},{value:"II. Installing OpenPype Importer Service for AYON",id:"ii-installing-openpype-importer-service-for-ayon",level:3},{value:"Install Addon",id:"install-addon",level:4},{value:"Create new bundle!",id:"create-new-bundle",level:4},{value:"Install Importer Service",id:"install-importer-service",level:4},{value:"III. Import Projects",id:"iii-import-projects",level:3},{value:"More reading:",id:"more-reading",level:2}],d={toc:l},c="wrapper";function m(e){let{components:t,...a}=e;return(0,r.kt)(c,(0,o.Z)({},d,a,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h2",{id:"introduction"},"Introduction"),(0,r.kt)("p",null,"You can import OpenPype projects into AYON, but it's not recommended for production purposes. There are some issues to be aware of, and the imported project won't exactly match the one in OpenPype. Before we dive in, let's go over some important points about this process."),(0,r.kt)("h3",{id:"what-makes-an-openpype-project"},"What makes an OpenPype project"),(0,r.kt)("p",null,"Typical OpenPype projects consists of two parts. The first part is the files themselves, which could be Maya scenes, Nuke scripts, or rendered images. These are typically divided into two areas: ",(0,r.kt)("inlineCode",{parentName:"p"},"work")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"publish"),". "),(0,r.kt)("p",null,"The work area contains the scenes from which published data is generated. This data might include loaded and versioned data that was previously published. There's a connection between these files; they depend on each other."),(0,r.kt)("p",null,"The second part of an OpenPype project is the metadata about versions and products. This information is stored in documents within a MongoDB database."),(0,r.kt)("p",null,"When you load a version of a product into your scene, a record is created somewhere, that references that particular version and its representation - this is the ID of the corresponding document in the MongoDB database."),(0,r.kt)("h3",{id:"differences"},"Differences"),(0,r.kt)("p",null,"An AYON project is quite similar at the file level, but AYON doesn't use MongoDB. This means all references to metadata stored in a database work differently. This is one of the issues when you import a project into AYON - those IDs won't function anymore and you won't be able to manage versions of loaded products in the scene, that was created in OpenPype anymore. Everything should appear the same in the scene because the importing process doesn't alter the files themselves. However, the IDs won't match those in AYON. If you need to change versions within that scene, you'll have to reload the product back in. The other option is to create a script that attempts to match OpenPype IDs with AYON ones. However, this second option involves a lot of guesswork and might not be reliable in some cases."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"What will remain the same:")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Files will be untouched and their relations (references, etc.) will be the same."),(0,r.kt)("li",{parentName:"ul"},"Project structure, assets, their products, versions and representations in AYON we reflect whatever was in OpenPype.")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"What will be lost:")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"References to loaded version in the scenes (workfiles) preventing versioning\nvia Manage tool."),(0,r.kt)("li",{parentName:"ul"},"Settings won't be transfered.")),(0,r.kt)("admonition",{type:"note"},(0,r.kt)("p",{parentName:"admonition"},"Thumbnails are supported, but you need to add folder where OpenPype is storing thumbnails for the project to the exported zip within ",(0,r.kt)("inlineCode",{parentName:"p"},"thumbnails")," folder.")),(0,r.kt)("h2",{id:"project-migration-prerequisites"},"Project Migration prerequisites"),(0,r.kt)("h3",{id:"i-exporting-project-from-openpype"},"I. Exporting project from OpenPype"),(0,r.kt)("admonition",{type:"note"},(0,r.kt)("p",{parentName:"admonition"},"You can only pack projects with one project root. For multi-root project, this is not currently supported.")),(0,r.kt)("p",null,"To migrate OpenPype project to AYON, you need to export it from OpenPype first. For that, you can use handy command ",(0,r.kt)("inlineCode",{parentName:"p"},"pack-project"),"."),(0,r.kt)("h4",{id:"export-from-termnial"},"Export from termnial:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"./openpype_console.exe pack-project --project NAME_OF_YOUR_PROJECT --dirpath ../export/path --dbonly\n")),(0,r.kt)("p",null,"OR  from the sources:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"./.poetry/bin/poetry run python start.py pack-project --project NAME_OF_YOUR_PROJECT --dirpath ../export/path --dbonly\n")),(0,r.kt)("p",null,"Just replace name of the project in ",(0,r.kt)("inlineCode",{parentName:"p"},"--project"),". Destination, where the project will be packed is specified by ",(0,r.kt)("inlineCode",{parentName:"p"},"--dirpath"),". Adding ",(0,r.kt)("inlineCode",{parentName:"p"},"--dbonly")," will dump only MongoDB documents. If you use ",(0,r.kt)("inlineCode",{parentName:"p"},"--dbonly"),", you also need to specify ",(0,r.kt)("inlineCode",{parentName:"p"},"--dirpath"),"."),(0,r.kt)("p",null,"This will produce ZIP file with the project files, ",(0,r.kt)("inlineCode",{parentName:"p"},"database.json")," file with the MongoDB dump and ",(0,r.kt)("inlineCode",{parentName:"p"},"metadata.json")," that contains the project root definitions. Lets keep this zip file for later and setup the importer service itself."),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"pack op project from terminal",src:n(87211).Z,width:"1960",height:"694"})),(0,r.kt)("h4",{id:"export-from-console"},"Export from console:"),(0,r.kt)("p",null,"Alternatively, you can call ",(0,r.kt)("inlineCode",{parentName:"p"},"pack-project")," from OpenPype's console as follows"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},'# ------------ Get All Projects ----------------\nfrom openpype.client import get_projects\n\ndef get_all_projects():\n    return [prj["name"] for prj in get_projects()]\n\n# You can print the names of your projects to be 100% sure you have the correct name.\nprint(get_all_projects())\n\n# -------------- Pack Project ------------------\nfrom openpype.lib.project_backpack import pack_project\n"""Check pack_project doc string for more info. """\n\nproject = "project_name"\ndestination_dir = "desired_output_path" # Optional path, Project\'s root is used if not passed.\ndbonly = True\npack_project(project, destination_dir, dbonly)\n')),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"pack op project from terminal",src:n(75960).Z,width:"841",height:"674"})),(0,r.kt)("h3",{id:"ii-setting-up-ash"},"II. Setting up ASH"),(0,r.kt)("p",null,"First requirement is to have ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/ynput/ash"},"ASH")," set up and running. ASH stands for ",(0,r.kt)("em",{parentName:"p"},"AYON Service Host")," and it takes\ncare for handling AYON Services. It Periodically checks the services declared in th AYON and starts\nthem if they are not running. Since OpenPype Importer Service can be started with ASH, let's firstly set it up:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"git clone https://github.com/ynput/ash.git\ncd ./ash\n# to build the Docker image\ndocker build -t ynput/ayon-ash:latest\n")),(0,r.kt)("p",null,"If you want ASH to be part of your AYON Docker stack, make sure that ",(0,r.kt)("inlineCode",{parentName:"p"},"docker-compose.yml")," in your\n",(0,r.kt)("a",{parentName:"p",href:"https://github.com/ynput/ayon-docker.git"},"ayon-docker")," has something like this in:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml"},'worker:\n    image: ynput/ayon-ash:latest\n    hostname: worker01\n    restart: unless-stopped\n    depends_on:\n      - server\n    volumes:\n      - "/var/run/docker.sock:/var/run/docker.sock"\n    environment:\n      - "AYON_API_KEY=xxxxxxxxxxxxxxxxxxxxxxx"\n      - "AYON_SERVER_URL=http://172.18.0.4:5000"\n')),(0,r.kt)("p",null,(0,r.kt)("em",{parentName:"p"},"NOTE:")," you can (and should) customize this to fit your needs. Be aware that ",(0,r.kt)("inlineCode",{parentName:"p"},"AYON_SERVER_URL")," must\nbe reachable from withing the Docker network, otherwise you'll get connection errors."),(0,r.kt)("p",null,"With these changes, you can run it with:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"docker compose up --detach --build worker\n")),(0,r.kt)("p",null,"If you rather like to run it manually with ",(0,r.kt)("inlineCode",{parentName:"p"},"docker"),", this command will do the same:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"# to run the image\ndocker run -rm -ti \\\n    -v /var/run/docker.sock:/var/run/docker.sock \\\n    --hostname worker01\n    --env AYON_API_KEY=xxxxxxxxxxxxxxxxxxxxxxx\n    --env AYON_SERVER_URL=http://172.18.0.4:5000\n    ynput/ayon-ash\n")),(0,r.kt)("p",null,"For development, you can also run it directly from Python 3.10+ using Poetry:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"poetry run -m ash\n")),(0,r.kt)("admonition",{type:"info"},(0,r.kt)("p",{parentName:"admonition"},(0,r.kt)("strong",{parentName:"p"},(0,r.kt)("font",{size:"4"},"Alternatively,"))," you can run ASH as a part of your main Ayon stack as mentioned in this community guide ",(0,r.kt)("a",{parentName:"p",href:"https://community.ynput.io/t/ayon-beta-testing-minimal-step-by-step-guide/699#ayon-server-host-ash-18"},"AYON Beta Testing - Minimal step by step guide")),(0,r.kt)("p",{parentName:"admonition"},"This can be much easier to set up if you are not familiar with docker.")),(0,r.kt)("h2",{id:"project-migration-steps"},"Project Migration Steps"),(0,r.kt)("h3",{id:"i-get-openpype-importer-addon"},"I. Get OpenPype Importer Addon"),(0,r.kt)("p",null,"You two options, choose your preferred option."),(0,r.kt)("h4",{id:"option-1-just-download-it"},"Option 1: Just Download It!"),(0,r.kt)("p",null,"Head to ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/ynput/ayon-openpype-import/releases"},(0,r.kt)("inlineCode",{parentName:"a"},"ayon-openpype-import")," releases github page")," and download the latest release."),(0,r.kt)("h4",{id:"option-2-export-the-addon-yourself"},"Option 2: Export the addon yourself"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"This is useful when you want to test the current development code!")),(0,r.kt)("p",null,"First, clone repository addon:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"git clone https://github.com/ynput/ayon-openpype-import\n")),(0,r.kt)("p",null,"Create server addon from the sources by running ",(0,r.kt)("inlineCode",{parentName:"p"},"create_package.py")," script:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"python ./create_package.py\n")),(0,r.kt)("h3",{id:"ii-installing-openpype-importer-service-for-ayon"},"II. Installing OpenPype Importer Service for AYON"),(0,r.kt)("h4",{id:"install-addon"},"Install Addon"),(0,r.kt)("p",null,"You'll find your freshly created addon zip in ",(0,r.kt)("inlineCode",{parentName:"p"},"package"),"."),(0,r.kt)("p",null,"Next step is to upload this addon to AYON server. In AYON, press ",(0,r.kt)("inlineCode",{parentName:"p"},"S+S")," or go to ",(0,r.kt)("inlineCode",{parentName:"p"},"Studio Settings -> Bundles"),". From there, click on ",(0,r.kt)("inlineCode",{parentName:"p"},"Install addons")," and drag'n'drop ",(0,r.kt)("inlineCode",{parentName:"p"},"openpype-import-x.x.x.zip")," into the dialog."),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Install Addon",src:n(73922).Z,width:"412",height:"414"})),(0,r.kt)("h4",{id:"create-new-bundle"},"Create new bundle!"),(0,r.kt)("p",null,"After upload, restart the server, create new bundle, and set OP importer addon version."),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Set Addon Version",src:n(97181).Z,width:"879",height:"119"})),(0,r.kt)("h4",{id:"install-importer-service"},"Install Importer Service"),(0,r.kt)("p",null,"As soon as you set your bundle to production and restart the server, you will notice the OpenPype Import tab.\n",(0,r.kt)("img",{alt:"OP Import Tab",src:n(8813).Z,width:"1696",height:"437"})),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"However, you still need to install the service for the tab to work.")),(0,r.kt)("p",null,"Go to services and create new service."),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"services",src:n(37801).Z,width:"537",height:"568"}),"\n",(0,r.kt)("img",{alt:"install service",src:n(71078).Z,width:"449",height:"474"})),(0,r.kt)("h3",{id:"iii-import-projects"},"III. Import Projects"),(0,r.kt)("p",null,"Finally, Import OP projects."),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Import",src:n(37174).Z,width:"1897",height:"919"})),(0,r.kt)("hr",null),(0,r.kt)("h2",{id:"more-reading"},"More reading:"),(0,r.kt)("p",null,(0,r.kt)("em",{parentName:"p"},"ASH Service and OpenPype Import"),": ",(0,r.kt)("a",{parentName:"p",href:"https://community.ynput.io/t/using-ayon-service-host/118"},"https://community.ynput.io/t/using-ayon-service-host/118")))}m.isMDXComponent=!0},73922:(e,t,n)=>{n.d(t,{Z:()=>o});const o=n.p+"assets/images/ayon_install_addon_1-83befcbbbe93e8a3c6ac4ec394eca39b.png"},37174:(e,t,n)=>{n.d(t,{Z:()=>o});const o=n.p+"assets/images/import_project-5f300328934dc0d32ef8bed1a78a7276.gif"},71078:(e,t,n)=>{n.d(t,{Z:()=>o});const o=n.p+"assets/images/install_service-72aa314dc02fb036591882b2048bc37c.png"},8813:(e,t,n)=>{n.d(t,{Z:()=>o});const o=n.p+"assets/images/op_import_tab-ee3983e627d5177f82a323cce1c813ab.png"},75960:(e,t,n)=>{n.d(t,{Z:()=>o});const o=n.p+"assets/images/pack_op_project_from_console-15c5fceae0775576e196c6bd588693d7.png"},87211:(e,t,n)=>{n.d(t,{Z:()=>o});const o=n.p+"assets/images/pack_op_project_from_terminal-68e3bbc8f05b7ef276aa1fced3c86255.png"},37801:(e,t,n)=>{n.d(t,{Z:()=>o});const o=n.p+"assets/images/services-21701e7c7cafb7f02248d24f7c5e163a.png"},97181:(e,t,n)=>{n.d(t,{Z:()=>o});const o=n.p+"assets/images/set_op_import_addon_version-5e7cead9801d994c600ce86c0c2bf837.png"}}]);