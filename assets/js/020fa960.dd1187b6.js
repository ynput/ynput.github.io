"use strict";(self.webpackChunkayon_docs=self.webpackChunkayon_docs||[]).push([[9501],{78105:(t,e,n)=>{n.r(e),n.d(e,{assets:()=>l,contentTitle:()=>r,default:()=>m,frontMatter:()=>i,metadata:()=>s,toc:()=>d});var a=n(87462),o=(n(67294),n(3905));const i={id:"addon_usd_artist_contribution_workflow",title:"AYON USD Contribution Workflow",sidebar_label:"Contribution Workflow"},r=void 0,s={unversionedId:"addon_usd_artist_contribution_workflow",id:"addon_usd_artist_contribution_workflow",title:"AYON USD Contribution Workflow",description:"Automatically contribute products into USD assets or shots",source:"@site/docs/addon_usd_artist_contribution_workflow.md",sourceDirName:".",slug:"/addon_usd_artist_contribution_workflow",permalink:"/docs/addon_usd_artist_contribution_workflow",draft:!1,editUrl:"https://github.com/ynput/ayon-documentation/tree/main/website/docs/addon_usd_artist_contribution_workflow.md",tags:[],version:"current",frontMatter:{id:"addon_usd_artist_contribution_workflow",title:"AYON USD Contribution Workflow",sidebar_label:"Contribution Workflow"},sidebar:"artist",previous:{title:"Getting Started",permalink:"/docs/addon_usd_artist_get_started"},next:{title:"Maya Workflow",permalink:"/docs/addon_usd_artist_maya_workflow"}},l={},d=[{value:"What is it?",id:"what-is-it",level:2},{value:"Configuring the USD Contribution",id:"configuring-the-usd-contribution",level:2},{value:"Asset contribution to <code>usdAsset</code>",id:"asset-contribution-to-usdasset",level:3},{value:"Shot contribution to <code>usdShot</code>",id:"shot-contribution-to-usdshot",level:3},{value:"Disabling USD contribution workflow",id:"disabling-usd-contribution-workflow",level:3},{value:"Add as variant - or not?",id:"add-as-variant---or-not",level:2},{value:"Add as variant ENABLED",id:"add-as-variant-enabled",level:3},{value:"Add as variant DISABLED",id:"add-as-variant-disabled",level:3},{value:"Contributions are additive",id:"contributions-are-additive",level:2},{value:"Removing contributions",id:"removing-contributions",level:2},{value:"Removing contributions manually",id:"removing-contributions-manually",level:3},{value:"Removing a department layer from the target product",id:"removing-a-department-layer-from-the-target-product",level:4},{value:"Removing a single contribution in a department layer",id:"removing-a-single-contribution-in-a-department-layer",level:4}],u={toc:d},p="wrapper";function m(t){let{components:e,...i}=t;return(0,o.kt)(p,(0,a.Z)({},u,i,{components:e,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"Automatically contribute products into USD assets or shots"),(0,o.kt)("admonition",{type:"info"},(0,o.kt)("p",{parentName:"admonition"},"The ",(0,o.kt)("strong",{parentName:"p"},"AYON USD Contribution Workflow")," was introduced with PR ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/ynput/ayon-core/pull/295"},"Implement USD workflow with global asset/shot contributions plug-in")," ")),(0,o.kt)("h2",{id:"what-is-it"},"What is it?"),(0,o.kt)("p",null,"The AYON USD Contribution Workflow allows to create small contribution publishes from DCCs with USD export support to directly add your publish into an asset's model or look variants or a shot's department layers. Automatically building up the USD structure for you."),(0,o.kt)("p",null,"Traditionally each department or artist would generate multiple products that downstream departments would load individually. For example, a lighting department may load each character animation product, each FX product individually."),(0,o.kt)("p",null,"So there would be some scattered products like:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"- pointcacheMain\n- pointcacheFX_building\n- animationChar01\n")),(0,o.kt)("p",null,"However, ",(0,o.kt)("strong",{parentName:"p"},"USD can reference and layer non-destructively")," which means we can safely merge these together at any point. Also making it easy for multiple departments to stack their own opinions and changes onto the departments before you."),(0,o.kt)("p",null,"This is where the USD Asset Contribution workflow automates this for you."),(0,o.kt)("p",null,"With the ",(0,o.kt)("strong",{parentName:"p"},"USD Contribution")," enabled on the USD publish instances this means it will automatically add your product into the department layer for the Asset or Shot."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"- usdShot\n    - usdShot_animation\n        - animationChar01\n        - pointcacheMain\n    - usdShot_fx\n        - pointcacheFX_building\n")),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"TL;DR")),(0,o.kt)("p",null,"With AYON's USD Contribution each product publish adds up into the target USD asset or USD shot. \ud83c\udf89 "),(0,o.kt)("h2",{id:"configuring-the-usd-contribution"},"Configuring the USD Contribution"),(0,o.kt)("p",null,"You can configure the USD contribution for an instance using the publisher UI on the ",(0,o.kt)("em",{parentName:"p"},"Publish")," tab selecting the USD instance. The right hand side will show a ",(0,o.kt)("strong",{parentName:"p"},"USD Contribution")," section."),(0,o.kt)("h3",{id:"asset-contribution-to-usdasset"},"Asset contribution to ",(0,o.kt)("inlineCode",{parentName:"h3"},"usdAsset")),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"AYON USD Contribution to Asset in Publisher UI",src:n(90274).Z,width:"413",height:"222"}),(0,o.kt)("br",{parentName:"p"}),"\n",(0,o.kt)("em",{parentName:"p"},"This example publishes an asset contribution to the look department layer")),(0,o.kt)("p",null,"Asset contributions usually have ",(0,o.kt)("a",{parentName:"p",href:"#add-as-variant-enabled"},"Add as variant ",(0,o.kt)("strong",{parentName:"a"},"enabled"))," so that multiple contributions to that department layer each become a variant. Publishing product ",(0,o.kt)("inlineCode",{parentName:"p"},"lookMain")," and product ",(0,o.kt)("inlineCode",{parentName:"p"},"lookDamaged")," with both set to add as variant will provide a variant set where you can switch between the two."),(0,o.kt)("admonition",{type:"tip"},(0,o.kt)("p",{parentName:"admonition"},"Enable the ",(0,o.kt)("em",{parentName:"p"},"Set as default variant selection")," to make that product become the default variant in target variant set.")),(0,o.kt)("h3",{id:"shot-contribution-to-usdshot"},"Shot contribution to ",(0,o.kt)("inlineCode",{parentName:"h3"},"usdShot")),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"AYON USD Contribution to Shot in Publisher UI",src:n(91378).Z,width:"404",height:"218"}),(0,o.kt)("br",{parentName:"p"}),"\n",(0,o.kt)("em",{parentName:"p"},"This example publishes a shot contribution to the FX department layer")),(0,o.kt)("p",null,"Shot contributions usually have a different target product, like ",(0,o.kt)("inlineCode",{parentName:"p"},"usdShot"),". "),(0,o.kt)("p",null,"In the majority of cases when contributing to a shot you want to ",(0,o.kt)("a",{parentName:"p",href:"#add-as-variant-disabled"},(0,o.kt)("strong",{parentName:"a"},"disable")," Add As Variant")," because for a shot, if multiple contributions are made to one department layer those should usually live alongside each other and are ",(0,o.kt)("em",{parentName:"p"},"not")," variants of each other. "),(0,o.kt)("admonition",{type:"warning"},(0,o.kt)("p",{parentName:"admonition"},"Currently it is a manual process to target ",(0,o.kt)("inlineCode",{parentName:"p"},"usdShot")," instead of ",(0,o.kt)("inlineCode",{parentName:"p"},"usdAsset")," for shot contributions.",(0,o.kt)("br",{parentName:"p"}),"\n","It is a ",(0,o.kt)("strong",{parentName:"p"},"common mistake to forget changing the target product"),", so be aware!"),(0,o.kt)("p",{parentName:"admonition"},"Improvements to that workflow using better preset configurations are planned.")),(0,o.kt)("admonition",{title:"Defining the target product name.",type:"note"},(0,o.kt)("p",{parentName:"admonition"},"Technically the ",(0,o.kt)("em",{parentName:"p"},"Target Product")," can be any name you like, you could make any number of target product assets in a single folder each with department layers of their own. "),(0,o.kt)("p",{parentName:"admonition"},"However, it is usually ",(0,o.kt)("strong",{parentName:"p"},"good practice")," to maintain a single ",(0,o.kt)("inlineCode",{parentName:"p"},"usdAsset")," in an asset and a single ",(0,o.kt)("inlineCode",{parentName:"p"},"usdShot")," in shots.")),(0,o.kt)("admonition",{title:"Initialize as asset or shot",type:"note"},(0,o.kt)("p",{parentName:"admonition"},"The ",(0,o.kt)("em",{parentName:"p"},"Initialize as")," setting is ",(0,o.kt)("strong",{parentName:"p"},"only")," relevant if the target product does not exist yet - so it is only used on first time generation of that file. It defines the asset structure, like USD payloads, asset info for the target product's USD file."),(0,o.kt)("p",{parentName:"admonition"},"For now, set asset targets to initialize as asset, set shot targets to initialize as shots. However, we're looking to streamline this with better preset configurations.")),(0,o.kt)("h3",{id:"disabling-usd-contribution-workflow"},"Disabling USD contribution workflow"),(0,o.kt)("p",null,"If you just disable the ",(0,o.kt)("strong",{parentName:"p"},"USD Contribution > Enable")," checkbox you will write out just the USD file using the host's export methods without any automated layering into another product - as such, disabling that means that all the settings underneath it do nothing at all. (They should appear greyed out, but unfortunately it's a limitation of the publisher UI that it can't currently)"),(0,o.kt)("h2",{id:"add-as-variant---or-not"},"Add as variant - or not?"),(0,o.kt)("p",null,"In most cases:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"an ",(0,o.kt)("strong",{parentName:"li"},"asset")," contribution is a variant."),(0,o.kt)("li",{parentName:"ul"},"a ",(0,o.kt)("strong",{parentName:"li"},"shot")," contribution is ",(0,o.kt)("strong",{parentName:"li"},"not")," a variant.")),(0,o.kt)("h3",{id:"add-as-variant-enabled"},"Add as variant ENABLED"),(0,o.kt)("p",null,"When enabling ",(0,o.kt)("em",{parentName:"p"},"Add as variant")," it means your single contribution will be added as a variant in a variant set on the asset's root primitive (the default prim). As such, multiple variant contributions to the same department layer (and same variant set) are not active at the same time, but they are switchable variants. So you can for example:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Publish a model main variant"),(0,o.kt)("li",{parentName:"ul"},"Publish a model damaged variant")),(0,o.kt)("p",null,"Now in the USD asset on the root primitive you may have a variant set ",(0,o.kt)("em",{parentName:"p"},"model")," that contains your ",(0,o.kt)("em",{parentName:"p"},"modelMain")," and ",(0,o.kt)("em",{parentName:"p"},"modelDamaged")," variants that downstream departments can switch between in your asset."),(0,o.kt)("h3",{id:"add-as-variant-disabled"},"Add as variant DISABLED"),(0,o.kt)("p",null,"With ",(0,o.kt)("em",{parentName:"p"},"Add as variant")," ",(0,o.kt)("strong",{parentName:"p"},"disabled")," each contribution to a single department layer is just added as essentially another layer - meaning that the contributions inside a single department layer are all live at the same time."),(0,o.kt)("p",null,"You can for example:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Publish a FX shockwave"),(0,o.kt)("li",{parentName:"ul"},"Publish a FX building destruction")),(0,o.kt)("p",null,"Both to the FX department layer - one isn't necessarily 'in front of' the other they are both just unordered contributions in that layer, present at the same time."),(0,o.kt)("p",null,"So loading the shot with the FX layer will show both the shockwave and building destruction - you're not picking between the two."),(0,o.kt)("h2",{id:"contributions-are-additive"},"Contributions are additive"),(0,o.kt)("p",null,"Over time, contributing to the asset adds more products to the ",(0,o.kt)("inlineCode",{parentName:"p"},"usdAsset"),", across likely a variety of department layers.\nSay our current publish structure is:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"usdAsset              (target product)\n  - usdAsset_model    (department layer)\n    - usdModelMain    (single contribution product)\n")),(0,o.kt)("p",null,"Now publishing a ",(0,o.kt)("inlineCode",{parentName:"p"},"usdLookMain")," to department layer ",(0,o.kt)("inlineCode",{parentName:"p"},"look")," would make a new ",(0,o.kt)("inlineCode",{parentName:"p"},"usdAsset")," version:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"usdAsset              (target product)\n  - usdAsset_model    (department layer)\n    - usdModelMain    (single contribution product)\n  - usdAsset_look     (department layer)\n    - usdLookMain     (single contribution product)\n")),(0,o.kt)("p",null,"Then publishing another look variant ",(0,o.kt)("inlineCode",{parentName:"p"},"usdLookDamaged")," would make a new ",(0,o.kt)("inlineCode",{parentName:"p"},"usdAsset")," version:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"usdAsset              (target product)\n  - usdAsset_model    (department layer)\n    - usdModelMain    (single contribution product)\n  - usdAsset_look     (department layer)\n    - usdLookMain     (single contribution product)\n    - usdLookDamaged  (single contribution product)\n")),(0,o.kt)("admonition",{title:"Contribution workflow is 'additive' to the target product's department layers",type:"note"},(0,o.kt)("p",{parentName:"admonition"},"Whenever publishing a product with contribution enabled it will add it to an existing target product's department layers (or ",(0,o.kt)("em",{parentName:"p"},"update")," if it's the exact same product)."),(0,o.kt)("p",{parentName:"admonition"},"This workflow makes it possible for different departments to simultaneously work on an asset and contribute to it additively.")),(0,o.kt)("h2",{id:"removing-contributions"},"Removing contributions"),(0,o.kt)("p",null,"There currently are no ready-to-go AYON tools that make it trivial to remove existing contributions from a product or department layer."),(0,o.kt)("p",null,"Unfortunately this means if you currently accidentally make a wrong contribution you will have to go and edit the actual USDA files' contents to remove entries."),(0,o.kt)("admonition",{type:"note"},(0,o.kt)("p",{parentName:"admonition"},"Providing tools for ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/ynput/ayon-usd/issues/23"},"easy editing of these existing contributions is on our issue tracker"),".")),(0,o.kt)("h3",{id:"removing-contributions-manually"},"Removing contributions manually"),(0,o.kt)("admonition",{type:"warning"},(0,o.kt)("p",{parentName:"admonition"},"This is a technical process and may leave your USD files in a broken state if not handled with care.")),(0,o.kt)("h4",{id:"removing-a-department-layer-from-the-target-product"},"Removing a department layer from the target product"),(0,o.kt)("p",null,"Your published ",(0,o.kt)("inlineCode",{parentName:"p"},"usdAsset")," may have department layers 'payloaded' in. In the ",(0,o.kt)("inlineCode",{parentName:"p"},"../publish/usd/usdAsset/v001/payload.usd")," file you may see for example:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-usda"},'#usda 1.0\n(\n    defaultPrim = "hero"\n    metersPerUnit = 1\n    subLayers = [\n        @C:\\projects\\ayontest\\asset\\hero\\publish\\usd\\usdAsset_look\\v001\\ynts_hero_usdAsset_look_v001.usd:SDF_FORMAT_ARGS:layer_id=look&order=300@,\n        @C:\\projects\\ayontest\\asset\\hero\\publish\\usd\\usdAsset_model\\v002\\ynts_hero_usdAsset_model_v002.usd:SDF_FORMAT_ARGS:layer_id=model&order=100@\n    ]\n    upAxis = "Y"\n)\n')),(0,o.kt)("p",null,"You can remove one of the ",(0,o.kt)("inlineCode",{parentName:"p"},"subLayers")," entries to completely remove a department layer from that published file.\nFor example, removing the look layer makes it."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-usda"},'#usda 1.0\n(\n    defaultPrim = "hero"\n    metersPerUnit = 1\n    subLayers = [\n        @C:\\projects\\ayontest\\asset\\hero\\publish\\usd\\usdAsset_model\\v002\\ynts_hero_usdAsset_model_v002.usd:SDF_FORMAT_ARGS:layer_id=model&order=100@\n    ]\n    upAxis = "Y"\n)\n')),(0,o.kt)("h4",{id:"removing-a-single-contribution-in-a-department-layer"},"Removing a single contribution in a department layer"),(0,o.kt)("p",null,"Your published ",(0,o.kt)("inlineCode",{parentName:"p"},"usdAsset_model")," will have the individual contributions to that layer. In the ",(0,o.kt)("inlineCode",{parentName:"p"},"../publish/usd/usdAsset_model/v001/..._v001.usd")," file you may see for example:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-usda"},'#usda 1.0\n(\n    defaultPrim = "hero"\n    metersPerUnit = 1\n    upAxis = "Y"\n)\n\ndef Xform "hero" (\n    variants = {\n        string model = "ModelMain"\n    }\n    prepend variantSets = "model"\n)\n{\n    variantSet "model" = {\n        "ModelMain" (\n            prepend references = [\n                @C:\\projects\\ayontest\\asset\\hero\\publish\\usd\\usdModelMain\\v001\\ynts_hero_usdModelMain_v001.usd@ (\n                    customData = {\n                        int ayon_order = 100\n                        string ayon_uri = "ayon://ayontest//asset/hero?product=usdModelMain&version=1&representation=usd"\n                    }\n                )\n            ]\n        ) {\n\n        }\n        "ModelPhotoreal" (\n            prepend references = [\n                @C:\\projects\\ayontest\\asset\\hero\\publish\\usd\\usdModelPhotoreal\\v001\\ynts_hero_usdModelPhotoreal_v001.usd@ (\n                    customData = {\n                        int ayon_order = 100\n                        string ayon_uri = "ayon://ayontest//asset/hero?product=usdModelPhotoreal&version=1&representation=usd"\n                    }\n                )\n            ]\n        ) {\n\n        }\n    }\n}\n')),(0,o.kt)("p",null,"To remove a single variant, like ",(0,o.kt)("inlineCode",{parentName:"p"},"ModelMain")," you can remove that block. In this case, make sure to also update the default variant set at the top of the file."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-usda"},'#usda 1.0\n(\n    defaultPrim = "hero"\n    metersPerUnit = 1\n    upAxis = "Y"\n)\n\ndef Xform "hero" (\n    variants = {\n        string model = "ModelPhotoreal"\n    }\n    prepend variantSets = "model"\n)\n{\n    variantSet "model" = {\n        "ModelPhotoreal" (\n            prepend references = [\n                @C:\\projects\\ayontest\\asset\\hero\\publish\\usd\\usdModelPhotoreal\\v001\\ynts_hero_usdModelPhotoreal_v001.usd@ (\n                    customData = {\n                        int ayon_order = 100\n                        string ayon_uri = "ayon://ayontest//asset/hero?product=usdModelPhotoreal&version=1&representation=usd"\n                    }\n                )\n            ]\n        ) {\n\n        }\n    }\n}\n')),(0,o.kt)("p",null,"Or remove the variant set completely:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-usda"},'#usda 1.0\n(\n    defaultPrim = "hero"\n    metersPerUnit = 1\n    upAxis = "Y"\n)\n\ndef Xform "hero" (\n)\n{\n\n}\n')),(0,o.kt)("p",null,"Which in this case leaves the empty root prim ",(0,o.kt)("inlineCode",{parentName:"p"},"hero"),"."),(0,o.kt)("hr",null),(0,o.kt)("admonition",{title:"TODO",type:"info"},(0,o.kt)("ul",{parentName:"admonition"},(0,o.kt)("li",{parentName:"ul"},"How to define or customize the layer strength "),(0,o.kt)("li",{parentName:"ul"},"Explain publisher UI asset contribution attributes to avoid confusion."),(0,o.kt)("li",{parentName:"ul"},"Explain general shot workflow in Maya"),(0,o.kt)("li",{parentName:"ul"},"Explain Rig -> Animation workflow to publish animations for shot workflows."))))}m.isMDXComponent=!0},90274:(t,e,n)=>{n.d(e,{Z:()=>a});const a=n.p+"assets/images/ayon_usd_contribution_to_asset-b7ef9be6dd838ccddc07609d06969016.png"},91378:(t,e,n)=>{n.d(e,{Z:()=>a});const a=n.p+"assets/images/ayon_usd_contribution_to_shot-0fcc4190f12bcc940e6f61c3f16a5a48.png"}}]);